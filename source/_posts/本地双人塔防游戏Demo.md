---
title: 本地双人塔防游戏Demo
---

> 本 Demo 来自 B 站课程学习的改进
>
> 作为自己的整理和找工作的项目 Demo
>
> 添加了自己的想法，记录在做这个 Demo 过程中比较重要的内容，可能会贴出部分源码

# 导入 SDL 相关的包

[SDL2 API 文档总览](https://wiki.libsdl.org/SDL2/CategoryAPI)

[cJSON 仓库链接](https://github.com/DaveGamble/cJSON)
[SDL2 仓库链接](https://github.com/libsdl-org/SDL)
[SDL_ttf 仓库链接](https://github.com/libsdl-org/SDL_ttf)
[SDL_mixer 仓库链接](https://github.com/libsdl-org/SDL_mixer)
[SDL_image 仓库链接](https://github.com/libsdl-org/SDL_image)
[SDL2_gfx 官网链接](https://www.ferzkopp.net/wordpress/2016/01/02/sdl_gfx-sdl2_gfx/)

## 下载 SDL2 的时候的 release 版本的信息解读

![image-20240909230926905](/BlogImg/image-20240909230926905.png)

文件名 `SDL2-devel-2.30.7-VC.zip` 中的各个部分通常遵循一定的命名规则，以下是对其命名含义的解释：

1. **`SDL2`**:

   - 代表 Simple DirectMedia Layer 2.0，即 SDL2，这是一个跨平台的多媒体开发库，广泛用于游戏开发、图形渲染和音频处理等领域。

2. **`devel`**:

   - `devel` 是 `development` 的缩写，表示这是一个开发版本的文件包，通常包含开发库、头文件和相关的工具，用于软件开发而不是仅仅用于运行时。这意味着你可以使用它来编译和开发依赖于 SDL2 的应用程序。

3. **`2.30.2`**:

   - 这是 SDL2 的版本号，表示这是 2.30.7 版本。版本号通常以

     ```
     主版本号.次版本号.修订号
     ```

     的形式表示，例如在此例中：

     - `2` 是主版本号，表示这是 SDL2 的第二个大版本。
     - `30` 是次版本号，表示自主版本 2 以来进行了 30 次功能更新或改进。
     - `7` 是修订号，表示这个版本在 `2.30` 基础上进行了七次小的修复或改进。

4. **`VC`**:

   - `VC` 代表 Visual C++，表示这个文件包是为 Microsoft Visual C++ 编译器和开发环境准备的。这通常意味着它包含了适用于 Visual Studio 的动态链接库（DLLs）、静态库（LIBs）、头文件（headers）等。

5. **`.zip`**:

   - 这是文件的扩展名，表示该文件是一个压缩包，使用 ZIP 压缩格式。你需要解压缩它以访问其中的内容。

### 总结

文件名 `SDL2-devel-2.30.2-VC.zip` 可以理解为：

- 这是 SDL2 库的开发版（包含开发所需的文件），
- 版本号是 2.30.2，
- 专门为 Visual C++ 编译器准备，
- 文件被打包为 ZIP 格式的压缩包。

## VS Studio 的一些设置

### 运行库设置

![属性页操作](/BlogImg/image-20240909233156816.png)

![右键项目最下面能看到属性](/BlogImg/image-20240909233309479.png)

![找到属性中的运行库](/BlogImg/image-20240909233333704.png)

### 不同选项的解释，来自 chatgpt-4o

在 Visual Studio 中，当你编译一个 C/C++ 程序时，可以选择不同的运行库（Runtime Library）选项。每个选项都有不同的特性，主要影响程序在运行时如何链接到 C/C++ 标准库以及线程安全性。以下是常见的运行库选项及其区别：

### 1. **多线程/单线程**

- **/MT** (Multithreaded): 编译器使用多线程的、静态链接的运行库。这意味着标准库的代码将被编译进生成的二进制文件中，不依赖外部的 DLL 文件。此选项适用于编译需要多线程支持的独立可执行文件。
- **/MTd** (Multithreaded Debug): 和 `/MT` 类似，但用于调试版本，包含调试信息。
- **/MD** (Multithreaded DLL): 编译器使用多线程的、动态链接的运行库。这意味着标准库的代码不会被编译进生成的二进制文件中，而是依赖外部的 `msvcrt.dll`（或调试版本的 `msvcrtd.dll`）。这是默认的运行库选项，适用于需要分发较小的可执行文件并且使用了动态链接库的项目。
- **/MDd** (Multithreaded DLL Debug): 和 `/MD` 类似，但用于调试版本，包含调试信息。

### 2. **静态链接 vs 动态链接**

- **静态链接** (`/MT`, `/MTd`):
  - 所有的运行时库代码都被嵌入到最终的可执行文件或库文件中。
  - 不依赖任何外部 DLL 文件。
  - 生成的文件较大，但在部署时不需要依赖额外的库文件。
- **动态链接** (`/MD`, `/MDd`):
  - 运行时库代码保存在外部的 DLL 文件中，最终的可执行文件中只包含对这些 DLL 的引用。
  - 生成的可执行文件较小，但在运行时必须确保相关的 DLL 文件可用。
  - 如果不同的模块使用不同的运行时库（比如一个模块用 `/MD`，另一个用 `/MT`），可能会导致内存管理问题（如内存分配与释放的不一致）。

### 3. **调试版 vs 发布版**

- **调试版** (`/MTd`, `/MDd`):
  - 包含调试信息，便于在调试器中运行程序。
  - 使用了调试版本的运行库，运行时性能可能较低，但提供了更多的错误检查机制。
- **发布版** (`/MT`, `/MD`):
  - 不包含调试信息，优化后的代码适用于发布版本。
  - 使用了非调试版本的运行库，运行时性能更好。

### 选择哪个运行库？

- **单独的可执行文件**: <font color="red">如果你需要一个不依赖外部 DLL 的独立可执行文件，可以选择 `/MT` 或 `/MTd`。</font>
- **使用动态链接库**: 如果你希望通过动态链接库减小可执行文件的大小并共享库代码，使用 `/MD` 或 `/MDd` 是更好的选择。
- **调试 vs 发布**: 在开发和调试阶段，选择调试版运行库（如 `/MDd`），在发布时切换到发布版运行库（如 `/MD`）。

## 第三方库的导入

- 导入头文件(include 文件夹)和静态(lib)或者动态链接库(dll)

![导入头文件和库文件](/BlogImg/image-20240909233954841.png)

- 导入头文件(include 文件夹)和源文件

![导入头文件和源文件](/BlogImg/image-20240909234021144.png)

## 头文件目录设置

![附加包含目录](/BlogImg/image-20240909234813783.png)

在 Visual Studio 中，“附加包含目录”（Additional Include Directories）是一个项目属性设置项，用于指定编译器在编译项目时需要查找的头文件目录。

### 作用

当你在代码中使用 `#include` 指令引用头文件时，编译器需要知道这些头文件的位置。编译器默认会在以下地方查找头文件：

1. **当前源文件所在的目录**。
2. **系统默认的包含目录**（如 C++ 标准库的头文件目录）。

如果你的项目中使用了自定义的头文件，或者你依赖于外部库的头文件，这些头文件可能位于编译器默认查找路径之外。此时，你需要通过“附加包含目录”将这些头文件所在的路径告诉编译器。

### 如何设置

在 Visual Studio 中，你可以通过以下步骤设置“附加包含目录”：

1. 右键点击你的项目，选择“属性”（Properties）。
2. 在项目属性窗口中，导航到“配置属性”（Configuration Properties） -> “C/C++” -> “常规”（General）。
3. 在右侧的“附加包含目录”一栏中，添加需要包含的头文件目录路径。可以手动输入路径，或点击旁边的按钮选择目录。

### 例子

假设你正在编译一个 C++ 项目，并且你使用了一个外部库 `MyLibrary`，它的头文件存放在 `C:\Libraries\MyLibrary\include` 目录下。在你的代码中，你可能会有这样的包含语句：

```cpp
#include <MyLibrary.h>
```

为了让编译器找到 `MyLibrary.h` 文件，你需要将 `C:\Libraries\MyLibrary\include` 路径添加到“附加包含目录”中。

## 库文件目录设置

![库文件目录设置](/BlogImg/image-20240909235154768.png)

在 Visual Studio 中，“附加库目录”（Additional Library Directories）是项目属性设置中的一项，用于指定链接器在链接阶段需要查找库文件（如 `.lib` 文件）的目录。

### 作用

当你编写的程序需要链接到外部库（如第三方库或自己编写的库）时，链接器需要知道这些库文件的位置。库文件通常包含了程序中使用的函数、类等的预编译代码，而链接器的任务就是将这些库与您的代码结合，生成最终的可执行文件。

默认情况下，链接器会在以下地方查找库文件：

1. **系统默认的库目录**（例如，Windows SDK 中的库目录）。
2. **项目文件所在的目录**。

如果你的项目使用的库文件不在这些默认目录中，你就需要通过“附加库目录”告诉链接器这些库文件所在的位置。

### 如何设置

在 Visual Studio 中，你可以通过以下步骤设置“附加库目录”：

1. 右键点击你的项目，选择“属性”（Properties）。
2. 在项目属性窗口中，导航到“配置属性”（Configuration Properties） -> “链接器”（Linker） -> “常规”（General）。
3. 在右侧的“附加库目录”一栏中，添加需要包含的库文件目录路径。你可以手动输入路径，也可以点击旁边的按钮来选择目录。

### 例子

假设你正在编译一个 C++ 项目，并且使用了一个外部库 `MyLibrary`，其库文件存放在 `C:\Libraries\MyLibrary\lib` 目录下。在你的代码中，你可能需要链接到这个库的 `.lib` 文件。

为了让链接器找到这些库文件，你需要将 `C:\Libraries\MyLibrary\lib` 路径添加到“附加库目录”中。

### 关联设置：附加依赖项

在设置了“附加库目录”后，你还需要在“附加依赖项”（Additional Dependencies）中指定要链接的具体库文件名（如 `MyLibrary.lib`），这个选项也位于链接器的属性设置中。设置路径后，链接器会在指定的“附加库目录”中查找这些库文件。

### lib 和 dll 的区别

#### 1. **`lib` 文件**

`lib` 文件通常有两种形式，分别用于不同的目的：

- **静态库（Static Library）**:
  - **作用**: 在编译时将库代码直接嵌入到可执行文件中。
  - **链接**: 编译器将静态库中的代码与应用程序的代码结合，生成一个包含所有必要代码的独立可执行文件。
  - **部署**: 生成的可执行文件不依赖外部库，体积会比较大，但运行时不需要额外的库文件。
  - **扩展名**: `.lib`
- **导入库（Import Library）**:
  - **作用**: 为动态链接库（DLL）提供链接信息。
  - **链接**: 导入库不包含实际的代码，只包含 DLL 中函数和变量的符号信息。在编译时使用导入库，告诉链接器将来需要使用特定的 DLL 文件。
  - **部署**: 可执行文件在运行时依赖 DLL 文件，导入库仅在编译和链接阶段使用。
  - **扩展名**: `.lib`

#### 2. **`dll` 文件**

- 动态链接库（Dynamic Link Library）:

  - **作用**: 提供可在运行时加载并使用的库函数和数据。DLL 文件可以被多个程序同时使用，从而节省内存和减少重复代码。
  - **链接**: 在运行时加载 DLL 文件，应用程序通过动态链接来调用其中的函数。编译时，程序通过导入库（`.lib` 文件）或使用 `LoadLibrary` 等 API 函数来引用 DLL 中的函数。
  - **部署**: DLL 文件需要与可执行文件一起部署。当应用程序运行时，系统会在特定目录中查找并加载 DLL 文件。
  - **扩展名**: `.dll`

#### 3. **主要区别**

- **链接方式**:
  - **静态库**: 在编译时链接，生成的可执行文件不需要依赖外部库。
  - **动态库**: 在运行时链接，可执行文件在运行时需要加载对应的 DLL。
- **文件扩展名**:
  - **静态库/导入库**: `.lib`
  - **动态库**: `.dll`
- **内存占用**:
  - **静态库**: 由于库代码被嵌入到可执行文件中，多个应用程序会各自占用内存。
  - **动态库**: DLL 可以被多个程序同时加载，节省内存。
- **更新与维护**:
  - **静态库**: 如果库代码需要更新，必须重新编译所有使用该库的程序。
  - **动态库**: 更新 DLL 文件后，所有使用该 DLL 的程序都能立即受益于更新，无需重新编译。

#### 小结

- **静态库（.lib）**: 编译时链接，库代码直接嵌入到可执行文件中。
- **动态链接库（.dll）**: 运行时链接，可执行文件依赖于外部的 DLL 文件。
- **导入库（.lib）**: 用于编译时链接到 DLL，提供符号信息，但不包含实际代码。

## 链接库文件

![链接库文件](/BlogImg/image-20240909235827283.png)

在 Visual Studio 中，“附加依赖项”（Additional Dependencies）是一个链接器设置项，用于指定在编译和链接过程中，程序需要链接的库文件（通常是 `.lib` 文件）。

### 作用

“附加依赖项”告诉链接器，除了默认的系统库外，还需要链接哪些特定的库文件。库文件包含预编译的代码或数据，程序在编译和链接时将这些库中的内容整合到最终生成的可执行文件或动态链接库中。

### 如何设置

你可以通过以下步骤在 Visual Studio 中设置“附加依赖项”：

1. 右键点击你的项目，选择“属性”（Properties）。
2. 在项目属性窗口中，导航到“配置属性”（Configuration Properties） -> “链接器”（Linker） -> “输入”（Input）。
3. 在右侧的“附加依赖项”一栏中，输入需要链接的库文件名，文件名之间用分号隔开。例如：`MyLibrary.lib;AnotherLibrary.lib`。

### 例子

假设你正在编译一个项目，该项目依赖于两个外部库 `MyLibrary.lib` 和 `AnotherLibrary.lib`。你需要将这两个库的名称添加到“附加依赖项”中，如下所示：

```
MyLibrary.lib;AnotherLibrary.lib
```

### 与“附加库目录”的关系

“附加依赖项”指定了需要链接的库文件名，而“附加库目录”指定了这些库文件所在的路径。链接器会在“附加库目录”中查找“附加依赖项”中列出的库文件。如果库文件不在默认路径中，你需要在“附加库目录”中指定正确的路径，否则链接器将无法找到并链接这些库文件。

### 小结

- **附加依赖项**: 指定在链接阶段需要链接的库文件名（通常是 `.lib` 文件）。
- **附加库目录**: 指定这些库文件所在的路径。

## DLL 的文件设置

> 就放在 main.cpp 同级目录下，具体怎么加载还不知道

![dll文件缩放位置的参考](/BlogImg/image-20240910000249147.png)

## 其他源文件的导入

![新建筛选器](/BlogImg/image-20240910000425931.png)

- 源文件拖拽到新建筛选器下方，导入的时候会自己找到这个源文件的，不是复制

![源文件拖拽到新建筛选器下方](/BlogImg/image-20240910000502340.png)
